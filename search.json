[
  {
    "objectID": "publications.html",
    "href": "publications.html",
    "title": "publications",
    "section": "",
    "text": "google scholar\nhttps://orcid.org/0000-0003-3777-3843\nHennecke, Justus, Leonardo Bassi, Cynthia Albracht, Angelos Amyntas, Joana Bergmann, Nico Eisenhauer, Aaron Fox, et al.¬†2024. ‚ÄúPlant Species Richness and the Root Economics Space Drive Soil Fungal Communities.‚Äù Ecology Letters 28 (1). https://doi.org/10.1111/ele.70032.\nAmyntas, Angelos, Nico Eisenhauer, Stefan Scheu, Bernhard Klarner, Krassimira Ilieva-Makulec, Anna-Maria Madaj, Benoit Gauzens, et al.¬†2024. ‚ÄúSoil Community History Strengthens Belowground Multitrophic Functioning Across Plant Diversity Levels in a Grassland Experiment.‚Äù Nature Communications 15 (1). https://doi.org/10.1038/s41467-024-54401-z.\nS√ºnnemann, Marie, Andrew D. Barnes, Angelos Amyntas, Marcel Ciobanu, Malte Jochum, Alfred Lochner, Anton M. Potapov, et al.¬†2024. ‚ÄúSustainable Land Use Strengthens Microbial and Herbivore Controls in Soil Food Webs in Current and Future Climates.‚Äù Global Change Biology 30 (11). https://doi.org/10.1111/gcb.17554.\nLi, Yi, Andreas Schuldt, Anne Ebeling, Nico Eisenhauer, Yuanyuan Huang, Georg Albert, Cynthia Albracht, et al.¬†2024. ‚ÄúPlant Diversity Enhances Ecosystem Multifunctionality via Multitrophic Diversity.‚Äù Nature Ecology & Evolution, August, 1‚Äì11. https://doi.org/10.1038/s41559-024-02517-2.\nDyer, Alexander, Remo Ryser, Ulrich Brose, Angelos Amyntas, Nora Bodnar, Thomas Boy, Solveig Franziska Bucher, et al.¬†2023. ‚ÄúInsect Communities Under Skyglow: Diffuse Night-Time Illuminance Induces Spatio-Temporal Shifts in Movement and Predation.‚Äù Philosophical Transactions of the Royal Society B: Biological Sciences 378 (1892). https://doi.org/10.1098/rstb.2022.0359.\nAmyntas, Angelos, Emilio Berti, Benoit Gauzens, Georg Albert, Wentao Yu, Alexandra S. Werner, Nico Eisenhauer, and Ulrich Brose. 2023. ‚ÄúNiche Complementarity Among Plants and Animals Can Alter the Biodiversityecosystem Functioning Relationship.‚Äù Functional Ecology 37 (10): 2652‚Äì65. https://doi.org/10.1111/1365-2435.14419.\nTerlau, J√∂rdis F., Ulrich Brose, Nico Eisenhauer, Angelos Amyntas, Thomas Boy, Alexander Dyer, Alban Gebler, et al.¬†2023. ‚ÄúMicrohabitat Conditions Remedy Heat Stress Effects on Insect Activity.‚Äù Global Change Biology 29 (13): 3747‚Äì58. https://doi.org/10.1111/gcb.16712.\nJochum, Malte, Andrew D. Barnes, Ulrich Brose, Benoit Gauzens, Marie S√ºnnemann, Angelos Amyntas, and Nico Eisenhauer. 2021. ‚ÄúFor Flux‚Äôs Sake: General Considerations for Energy-Flux Calculations in Ecological Communities.‚Äù Ecology and Evolution 11 (19): 12948‚Äì69. https://doi.org/10.1002/ece3.8060."
  },
  {
    "objectID": "posts/20240907-roots-stems-leaves/index.html",
    "href": "posts/20240907-roots-stems-leaves/index.html",
    "title": "Roots, stems & leaves",
    "section": "",
    "text": "Jevon and Lang (2022) examined how tree properties like leaf habit (evergreen vs deciduous) and type of mycorrhizal association (arbuscular vs ectomycorrhizal) can influence the relationship between tree size and biomass allocation, across 55 different tree species. Since this post is going to be light on ecology and heavy on stats, you might want to skim peruse their paper first. It‚Äôs really good!\nMy own interest in this data-set is twofold. Examining biomass allocation means that we are looking at proportions; not just the leaf biomass of a tree but the proportion of its total biomass that is leaves. Proportions, which are bound to (0,1), can be analysed using the Beta distribution, so that model estimates respect their bounded nature1. A tree can‚Äôt have more than 100% of its biomass in leaves and accordingly, a model using the Beta distribution will not make estimates outside the 0-1 range.\nWhile the Beta distribution allows us to model simple proportions (e.g.¬†proportion of biomass that is leaves vs not leaves), the Dirichlet distribution is an extension of the Beta that can accommodate proportions of more than two components (i.e.¬†proportions of biomass that are leaves, stems and roots)2. On the other hand, working with Dirichlet models is more cumbersome and I am not sure that we get more out of them than fitting three individual Beta models, one for each component. Let‚Äôs find out.\nThe other cool feature of Jevon and Lang (2022) is the phylogenetic tree in (their) Figure 1a, showing the relatedness of the 55 species of their study. The authors did use multilevel models to acount for observations clustered within studies and species but they did not make use of the phylogenetic tree in their analysis. We are going to try and use that information to account for the non-independence of related tree species. We are in luck, because {brms} supports this.\nThe authors of the original paper have made all their code available here. They‚Äôve also written a very clear Methods section, outlining every choice they made in the selection of the data, which are coming from the Biomass and Allometry Database3. I have largely retraced their wrangling steps, with minor adjustments4."
  },
  {
    "objectID": "posts/20240907-roots-stems-leaves/index.html#the-point-of-this-exercise",
    "href": "posts/20240907-roots-stems-leaves/index.html#the-point-of-this-exercise",
    "title": "Roots, stems & leaves",
    "section": "",
    "text": "Jevon and Lang (2022) examined how tree properties like leaf habit (evergreen vs deciduous) and type of mycorrhizal association (arbuscular vs ectomycorrhizal) can influence the relationship between tree size and biomass allocation, across 55 different tree species. Since this post is going to be light on ecology and heavy on stats, you might want to skim peruse their paper first. It‚Äôs really good!\nMy own interest in this data-set is twofold. Examining biomass allocation means that we are looking at proportions; not just the leaf biomass of a tree but the proportion of its total biomass that is leaves. Proportions, which are bound to (0,1), can be analysed using the Beta distribution, so that model estimates respect their bounded nature1. A tree can‚Äôt have more than 100% of its biomass in leaves and accordingly, a model using the Beta distribution will not make estimates outside the 0-1 range.\nWhile the Beta distribution allows us to model simple proportions (e.g.¬†proportion of biomass that is leaves vs not leaves), the Dirichlet distribution is an extension of the Beta that can accommodate proportions of more than two components (i.e.¬†proportions of biomass that are leaves, stems and roots)2. On the other hand, working with Dirichlet models is more cumbersome and I am not sure that we get more out of them than fitting three individual Beta models, one for each component. Let‚Äôs find out.\nThe other cool feature of Jevon and Lang (2022) is the phylogenetic tree in (their) Figure 1a, showing the relatedness of the 55 species of their study. The authors did use multilevel models to acount for observations clustered within studies and species but they did not make use of the phylogenetic tree in their analysis. We are going to try and use that information to account for the non-independence of related tree species. We are in luck, because {brms} supports this.\nThe authors of the original paper have made all their code available here. They‚Äôve also written a very clear Methods section, outlining every choice they made in the selection of the data, which are coming from the Biomass and Allometry Database3. I have largely retraced their wrangling steps, with minor adjustments4."
  },
  {
    "objectID": "posts/20240907-roots-stems-leaves/index.html#caveat-lector",
    "href": "posts/20240907-roots-stems-leaves/index.html#caveat-lector",
    "title": "Roots, stems & leaves",
    "section": "caveat lector",
    "text": "caveat lector\nI am not a forest ecologist. I have not spent nearly as much time5 thinking about the processes explored here, as the authors of the original study, nor can I match their expertise on the subject. The motivation behind this is not to question nor affirm the original study. The authors fitted an ecologically motivated model, which they then simplified aiming for parsimony. I am mainly interested in the technicalities of modelling proportions and accounting for phylogenetic relatedness. I will therefore start from the ground up, adding complexity, to see how far I get before I run into trouble. Again, the focus here is on model fitting, not ecology. But I am also, very emphatically, not a statistician. I have tried to explicitly justify every choice I have made and I would like to believe that my choices are sensible. But if you read this and you spot any mistakes, I would be grateful if you point them out to me."
  },
  {
    "objectID": "posts/20240907-roots-stems-leaves/index.html#baby-steps",
    "href": "posts/20240907-roots-stems-leaves/index.html#baby-steps",
    "title": "Roots, stems & leaves",
    "section": "baby steps",
    "text": "baby steps\nif you‚Äôd like to play along, the script is available here.\nLet‚Äôs start simple, by examining the effect of tree height on root, stem6 and leaf (relative) mass for a single species, Betula alleghaniensis. It‚Äôs a good place to start because it is the species with the largest number of individuals in the data (295 trees, unevenly distributed across three locations). Median height is 1.59 m with a range of 0.5-24.42 m. It‚Äôs worth keeping in mind that within-species variation in height and biomass allocation does not only depend on ontogeny but also influenced by the environment (e.g. competition with neighbouring trees, climate).\nBefore any model fitting, we are going to standardize our predictor, height; let‚Äôs divide the height of each B. alleghaniensis individual by the median height of that species and then take the base 2 logarithm of that quantity. The first of these steps brings individuals of median height at 1. The second step pushes them at 0 (log2(1) = 0) so that the intercepts, the model‚Äôs estimates at 0, will be the estimated proportions for a median individual of B. alleghaniensis and now a one-unit change (which is what the coefficient for the predictor corresponds to) amounts to a doubling of height. I‚Äôll do this for all species, not just the focal one.\n\n\nShow the code\nwithin.sp = full_df_mod %&gt;% \n  rename(roots = RmTm,\n         stems = SmTm,\n         leaves = LmTm) %&gt;% \n  # this is how brms expects the response for Dirichlet models \n  mutate(RSL = cbind(roots = .$roots,\n                     stems = .$stems,\n                     leaves = .$leaves)) %&gt;% \n  group_by(SppName) %&gt;% \n  mutate(.after = h.t,\n         ht.median = median(h.t),\n         rel.ht = log2(h.t/ht.median),\n         N = n()) %&gt;% \n  ungroup()\n\n\nNow we will first fit three Beta regression models, each one estimating the effect of relative height on the proportion of an individual‚Äôs total biomass that is roots, stems or leaves. We will let the intercept vary by study. Then we will estimate the same relationships but this time, fitting one model for all three proportions7.\n\nlibrary(brms)\nlibrary(tidybayes)\nlibrary(modelr)\n\n# one model for roots\nm.Bet_alle.r &lt;- brm(bf(roots ~ rel.ht + (1|Study)), \n                    data = within.sp %&gt;% \n                      filter(SppName == \"Betula_alleghaniensis\"), \n                    family = Beta(), \n                    chains = 4, \n                    iter = 6000, \n                    warmup = 3000, \n                    cores = 4, \n                    control = list(adapt_delta = 0.99),\n                    backend = \"cmdstanr\",\n                    file = \"fits/m.Bet_alle.r\",\n                    seed = 123)\npp_check(m.Bet_alle.r, ndraws = 200)\n\n# one model for stems\nm.Bet_alle.s &lt;- brm(bf(stems ~ rel.ht + (1|Study)), \n                    data = within.sp %&gt;% \n                      filter(SppName == \"Betula_alleghaniensis\"), \n                    family = Beta(), \n                    chains = 4, \n                    iter = 6000, \n                    warmup = 3000, \n                    cores = 4, \n                    control = list(adapt_delta = 0.99,\n                                   max_treedepth = 12),\n                    backend = \"cmdstanr\",\n                    file = \"fits/m.Bet_alle.s\",\n                    seed = 123)\npp_check(m.Bet_alle.s, ndraws = 200)\n\n# one model for leaves\nm.Bet_alle.l &lt;- brm(bf(leaves ~ rel.ht + (1|Study)), \n                    data = within.sp %&gt;% \n                      filter(SppName == \"Betula_alleghaniensis\"), \n                    family = Beta(), \n                    chains = 4, \n                    iter = 6000, \n                    warmup = 3000, \n                    cores = 4, \n                    control = list(adapt_delta = 0.99,\n                                   max_treedepth = 12),\n                    backend = \"cmdstanr\",\n                    file = \"fits/m.Bet_alle.l\",\n                    seed = 123)\npp_check(m.Bet_alle.l, ndraws = 200)\n\n\n# all in one\nm.Bet_alle.rsl &lt;- brm(bf(RSL ~ rel.ht + (1|Study)), \n                      data = within.sp %&gt;% \n                        filter(SppName == \"Betula_alleghaniensis\"), \n                      family = dirichlet(), \n                      chains = 4, \n                      iter = 9000, \n                      warmup = 3000, \n                      cores = 4, \n                      control = list(adapt_delta = 0.99,\n                                     max_treedepth = 12),\n                      backend = \"cmdstanr\",\n                      file = \"fits/m.Bet_alle.rsl\",\n                      seed = 123)\n# Total execution time: 751.3 seconds.\npp_check(m.Bet_alle.rsl, ndraws = 100)\n# Error: 'pp_check' is not implemented for this family.\n\nFirst sign of ‚Äútrouble‚Äù; we cannot use pp_check() for a Dirichlet regression, to assess how well the model captures the distribution of the data. We can make density overlay plots from scratch though:\n\nlibrary(bayesplot)\n# generate predictions\nyrep &lt;- posterior_predict(m.Bet_alle.rsl, ndraws = 200)\n# yrep is a three dimensional array:\n# 200 predictions x 295 observations x 3 response components\ndim(yrep)\n# here's one slice:\nyrep[1, 1, 1:3]\n#     roots     stems    leaves \n# 0.3791285 0.4160540 0.2048174\n\n# three custom-made density overlay plots, similar to the default pp_check() output\nppc_dens_overlay(within.sp$roots[within.sp$SppName == \"Betula_alleghaniensis\"], \n                 yrep[ , 1:295, 1])\nppc_dens_overlay(within.sp$stems[within.sp$SppName == \"Betula_alleghaniensis\"], \n                 yrep[ , 1:295, 2])\nppc_dens_overlay(within.sp$leaves[within.sp$SppName == \"Betula_alleghaniensis\"], \n                 yrep[ , 1:295, 3])\n\nAnd now we can compare the estimates of the two approaches. To make it easier to see any differences, I have combined the draws from the three Beta models before pushing them through {ggplot}, so that we can have one plot for the three Betas (left) and one for the Dirichlet regression (right):\n\n\nShow the code\nroot = within.sp %&gt;%\n  data_grid(rel.ht = seq_range(rel.ht, n = 51)) %&gt;%\n  add_epred_draws(m.Bet_alle.r, re_formula = NA) %&gt;% \n  add_column(.category = \"roots\")\n\nstem = within.sp %&gt;%\n  data_grid(rel.ht = seq_range(rel.ht, n = 51)) %&gt;%\n  add_epred_draws(m.Bet_alle.s, re_formula = NA) %&gt;% \n  add_column(.category = \"stems\")\n\nleaf = within.sp %&gt;%\n  data_grid(rel.ht = seq_range(rel.ht, n = 51)) %&gt;%\n  add_epred_draws(m.Bet_alle.l, re_formula = NA) %&gt;% \n  add_column(.category = \"leaves\")\n\nrsl = rbind(root,stem,leaf)\nrsl$.category = factor(rsl$.category, levels = c(\"roots\",\"stems\",\"leaves\"))\n\nfig1a = rsl %&gt;%\n  ggplot(aes(x = rel.ht, y = .epred, color = .category,\n             fill = .category)) +\n  geom_vline(xintercept = 0, linetype = \"dashed\", color = \"grey\") +\n  stat_lineribbon(aes(y = .epred), .width = c(0.9),\n                  point_interval = \"median_qi\",\n                  linewidth = .2)+\n  scale_x_continuous(breaks = c(-3,-1,0,1,3), \n                     labels = c(\"1/8\",\"1/2\",1,2,8)) +\n  scale_color_manual(values = c(\"#efd08e\",\"#8d8067\",\"#9dbc9b\")) +\n  scale_fill_manual(values = c(\"#efd08e80\",\"#8d806780\",\"#9dbc9b80\")) +\n  ylab(\"Biomass proportion\") +\n  xlab(\"multiplicative change in relative height\") +\n  theme_bw() +\n  theme(legend.position = \"none\") + \n  ggtitle(\"Predictions of three Beta regressions\")\n\nfig1b = within.sp %&gt;%\n  data_grid(rel.ht = seq_range(rel.ht, n = 51)) %&gt;%\n  add_epred_draws(m.Bet_alle.rsl, re_formula = NA) %&gt;%\n  ggplot(aes(x = rel.ht, y = .epred, color = .category,\n             fill = .category)) +\n  geom_vline(xintercept = 0, linetype = \"dashed\", color = \"grey\") +\n  stat_lineribbon(aes(y = .epred), .width = c(0.9),\n                  point_interval = \"median_qi\",\n                  linewidth = .2)+\n  scale_x_continuous(breaks = c(-3,-1,0,1,3), \n                     labels = c(\"1/8\",\"1/2\",1,2,8)) +\n  scale_color_manual(values = c(\"#efd08e\",\"#8d8067\",\"#9dbc9b\")) +\n  scale_fill_manual(values = c(\"#efd08e80\",\"#8d806780\",\"#9dbc9b80\")) +\n  ylab(\"Biomass proportion\") +\n  xlab(\"multiplicative change in relative height\") +\n  theme_bw() +\n  theme(legend.title = element_blank()) + \n  ggtitle(\"Predictions of Dirichlet regression\")\n\nlibrary(patchwork)\nfig1 = fig1a+fig1b\n\nggsave(\"figs/fig1.png\", fig1, units = \"mm\",\n       width = 180,\n       height = 75,\n       scale = 1.4)\n\n\n\n\n\nFigure 1: Model estimates with the two different approaches. Thin lines are the median estimates, bound by 90% credible envelopes.\n\n\nThey are not alarmingly different but you can see the wider uncertainty for the stem proportion across the height gradient and the change in the shape of the root-height relationship. The big picture is the same though and at this point, while we are only looking at one species and not yet asking how leaf habit or mycorrhizal association can modify this relationship, these differences are inconsequential.\nSo taller trees allocate increasingly more biomass to stems, relative to roots or leaves. An individual of median height is already around 50% stem, while leaves are the smallest proportion. (Probably not news to anyone studying tree allometry; I wouldn‚Äôt know)."
  },
  {
    "objectID": "posts/20240907-roots-stems-leaves/index.html#all-together-now",
    "href": "posts/20240907-roots-stems-leaves/index.html#all-together-now",
    "title": "Roots, stems & leaves",
    "section": "all together now",
    "text": "all together now\nGetting cocky, we are now going to throw the full dataset into the Dirichlet model. We now have 55 species with different leaf habits and mycorrhizal associations. Biomass allocation, as well as its relationship to height, may be influenced by these factors. I will cut a few corners here8, going directly to a model that includes relative height, habit and mycorrhizal group as well as their two-way interactions as predictors. We have a fairly sparse dataset with species information coming from more than one study/location while studies/locations feature more than one species. This sounds like a case for crossed random effects; we will account for the clustering of observations within species and within studies. We are also going to let the effect of height vary by species. Remember that we are still looking at within species height variation, with species‚Äô median height as our baseline. We‚Äôre just partially pooling information across species about the effects of within-species height variation on biomass allocation.\n\nm.all.rsl_hhm2 &lt;- brm(bf(RSL ~ (rel.ht  + leaf_habit + myc_group)^2 + \n                           (1 + rel.ht|SppName) + (1|Study)), \n                      data = within.sp, \n                      family = dirichlet(), \n                      chains = 4, \n                      iter = 9000, \n                      warmup = 3000, \n                      cores = 4, \n                      control = list(adapt_delta = 0.99,\n                                     max_treedepth = 12),\n                      backend = \"cmdstanr\",\n                      file = \"fits/m.all.rsl_hhm2\",\n                      seed = 123)\n# Total execution time: 4191.0 seconds.\n\nWe have now ramped up both the number of observations and, more importantly, the number of coefficients to be estimated. This model took a while to get there.\n\n\n\nFigure 2: Estimates of the Dirichlet model for all species, faceted by leaf habit and mycorrhizal association. Thin lines are the median estimates, bound by 90% credible envelopes.\n\n\nWhat stood out to me first, by eyeballing figure 2, is that ECM-associated trees seem to have a more pronounced stem to leaf biomass trade-off, especially above median height.\nHere are the model estimates at median height for the two leaf habits and mycorrhizal associations.\n\n\nShow the code\nfig3a = within.sp %&gt;% \n  data_grid(expand_grid(rel.ht = c(0),\n                        leaf_habit = c(\"deciduous\"),\n                        myc_group = c(\"ECM\",\"AM\"))) %&gt;% \n  add_epred_draws(m.all.rsl_hhm2,\n                  re_formula = NA) %&gt;% \n  mutate(group = str_c(.category, myc_group)) %&gt;% \n  ggplot(aes(x = .epred, fill = factor(group))) +\n  stat_halfeye(aes(shape = myc_group),\n               .width = c(.9),\n               size = 5,\n               alpha = .5) +\n  scale_fill_manual(values = c(\"#9dbc9b\",\"#9dbc9b\",\n                               \"#efd08e\",\"#efd08e\",\n                               \"#8d8067\",\"#8d8067\"),\n                    guide = \"none\") +\n  ylab(\"\") +\n  xlab(\"estimate\") +\n  facet_wrap(~.category,\n             scales = \"free\") +\n  theme_bw() + \n  ggtitle(\"Biomass allocation of deciduous trees at median height\")\n\nfig3b = within.sp %&gt;% \n  data_grid(expand_grid(rel.ht = c(0),\n                        leaf_habit = c(\"evergreen\"),\n                        myc_group = c(\"ECM\",\"AM\"))) %&gt;% \n  add_epred_draws(m.all.rsl_hhm2,\n                  re_formula = NA) %&gt;% \n  mutate(group = str_c(.category, myc_group)) %&gt;% \n  ggplot(aes(x = .epred, fill = factor(group))) +\n  stat_halfeye(aes(shape = myc_group),\n               .width = c(.9),\n               size = 5,\n               alpha = .5) +\n  scale_fill_manual(values = c(\"#9dbc9b\",\"#9dbc9b\",\n                               \"#efd08e\",\"#efd08e\",\n                               \"#8d8067\",\"#8d8067\"),\n                    guide = \"none\") +\n  ylab(\"\") +\n  xlab(\"estimate\") +\n  facet_wrap(~.category,\n             scales = \"free\") +\n  theme_bw() + \n  ggtitle(\"Biomass allocation of evergreen trees at median height\")\n\n\nfig3 = fig3a/fig3b\nggsave(\"figs/fig3.png\", fig3, units = \"mm\",\n       width = 180,\n       height = 120,\n       scale = 1.4)\n\n\n\n\n\nFigure 3: Estimated proportions at median height. Points are the median estimate bound by 90% credible intervals. Note that each facet has its own scale for the x axis. The y axis is not informative; I forgot to remove it."
  },
  {
    "objectID": "posts/20240907-roots-stems-leaves/index.html#the-other-kind-of-tree",
    "href": "posts/20240907-roots-stems-leaves/index.html#the-other-kind-of-tree",
    "title": "Roots, stems & leaves",
    "section": "the other kind of tree",
    "text": "the other kind of tree\nFinally, we can take our already complex multivariate, multivariable , varying intercepts, varying slopes regression model and have the intercepts and height slopes further constrained by phylogeny. This means that when we are partially pooling information across species, the extent of pooling depends on how closely related the different species are. You can read more about phylogenetic multilevel models with {brms} here. Getting the data set-up right was a process of trial and error, but {brms} throws fairly informative errors. We need:\n\na phylogenetic tree (provided by Jevon and Lang (2022)) to construct the variance-covariance matrix,\na grouping variable (phylo) telling us which node of the tree each observation belongs to, but this needs to be distinct from our species variable (SppName) even though they (must) contain the same information,\nthe names of the vcv matrix need to match the elements of phylo.\n\nNote that we are dealing with a phylogenetic model with repeated measurements within each node/species which is why we need to go through the SppName-phylo matching shenanigans. We‚Äôve also had not just the intercept but also the effect of height on biomass allocation be constrained by phylogeny. This model took a substantial amount of time to finish.\n\nlibrary(ape)\n# load the tree\nphylo = read.tree(\"phyliptree1.phy\")\n# phylogenetic variance-covariance matrix\nA = ape::vcv.phylo(phylo)\n# replaces \"name\" with name\ndimnames(A) = list(unique(within.sp$SppName),\n                   unique(within.sp$SppName))\n# grouping of observations by species (brms requires a distinct named variable)\nwithin.sp$phylo = within.sp$SppName\n\nm.all.rsl_hhm2_h.ph &lt;- brm(bf(RSL ~ (rel.ht  + leaf_habit + myc_group)^2 + \n                                (1 + rel.ht|gr(phylo, cov = A)) + (1 + rel.ht|SppName) + (1|Study)), \n                           data = within.sp, \n                           data2 = list(A = A),\n                           family = dirichlet(), \n                           chains = 4, \n                           iter = 9000, \n                           warmup = 3000, \n                           cores = 4, \n                           control = list(adapt_delta = 0.99,\n                                          max_treedepth = 12),\n                           backend = \"cmdstanr\",\n                           file = \"fits/m.all.rsl_hhm2_h.ph\",\n                           seed = 123)\n\nAnd here are the estimates of the phylogenetic model:\n\n\n\nFigure 4: Estimates of the phylogenetic model. Thin lines are the median estimates, bound by 90% credible envelopes.\n\n\nIf you compare it with the previous figure, the credible envelopes are chonkier. That‚Äôs as it should be; the information we get from each species is not independent from other, related species.\nFor completeness, here are the estimates of the three-Betas equivalent of the phylogenetic model.\nAnd finally, inspired by this amazing plot, let‚Äôs make our own version of figure 2d in Jevon and Lang (2022). We will stick with median height:\n\n\nShow the code\nlibrary(scales)\n\nfig5 = within.sp %&gt;%\n  data_grid(rel.ht = c(0),\n            leaf_habit = c(\"deciduous\",\n                           \"evergreen\"),\n            myc_group = c(\"ECM\",\"AM\")) %&gt;%\n  add_epred_draws(m.all.rsl_hhm2_h.ph, re_formula = NA) %&gt;% \n  mutate(.category=fct_relevel(.category,c(\"leaves\",\"stems\",\"roots\"))) %&gt;% \n  ggplot(aes(x = .draw, y = .epred)) +\n  geom_area(aes(fill = .category), position = position_stack()) +\n  labs(x = NULL, y = \"Proportion of total biomass\", fill = NULL) +\n  scale_x_continuous(breaks = NULL, expand = c(0, 0)) +\n  scale_y_continuous(labels = label_percent(), expand = c(0, 0)) +\n  scale_fill_manual(values = c(\"#9dbc9bcc\",\"#8d8067cc\",\"#efd08ecc\")) +\n  facet_wrap(leaf_habit~myc_group, strip.position = \"bottom\", nrow = 1) +\n  theme_bw()\n\nggsave(\"figs/fig5.png\", fig5, units = \"mm\",\n       width = 140,\n       height = 140,\n       scale = 1)\n\n\n\n\n\nFigure 5: Biomass allocation for an individual of median height. The fuzzy areas demonstrate the uncertainty for the expected proportions"
  },
  {
    "objectID": "posts/20240907-roots-stems-leaves/index.html#conclusions",
    "href": "posts/20240907-roots-stems-leaves/index.html#conclusions",
    "title": "Roots, stems & leaves",
    "section": "conclusions",
    "text": "conclusions\nA Dirichlet regression is three \\(n\\) Beta regressions in a trenchcoat ü§∑.\nWorking with the output of a Dirichlet model, to produce figures or to get estimates at specific values, was more straightforward than I anticipated. As far as I can tell, it is not possible to use {marginaleffects} or {emmeans} to calculate contrasts, for example. But these can be calculated manually from the posterior draws (left as an exercise for the reader üòâ).\nThe phylogenetic model is simple enough to specify but can be computationally prohibitive depending on your processor and RAM.\nTrees are interesting ü§î."
  },
  {
    "objectID": "posts/20240907-roots-stems-leaves/index.html#footnotes",
    "href": "posts/20240907-roots-stems-leaves/index.html#footnotes",
    "title": "Roots, stems & leaves",
    "section": "Footnotes",
    "text": "Footnotes\n\n\nI don‚Äôt need to go into that because there an excellent discussion here‚Ü©Ô∏é\nA few years back Douma and Weedon (2019) wrote a review on how to work with continuous proportions with these two distributions. Their overview of support for proportional models is only slightly out of date; brms does support Dirichlet models.‚Ü©Ô∏é\n(Falster et al. 2015)‚Ü©Ô∏é\nThe most important of them was extracting temperature and precipitation data from Worldclim 2.1 instead of 1.4. The latter is no longer accessible1.\n4.1: (a meta-footnote üòé) You‚Äôd think this is a breaking change but in their repository, Jevon and Lang include the bioclimatic data necessary to run their code without interruptions. So, from a strict reproducibility perspective, ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê‚Ü©Ô∏é\nThis is my twisted idea of a Sunday mornings‚Äô leisure activity.‚Ü©Ô∏é\nI was very invested in a shoots and leaves joke but\n\nthe roots spoil it\nturns out stems and shoots are not interchangeable. Apparently, any ecologist should know that.\n\n‚Ü©Ô∏é\nTechnically, were estimating two of them, getting the third one for free, which is why the Dirichlect model has n-1 of everything (intercepts, slope coefficients), for n components. This is similar to how in a Beta regression, we are implicitly also estimating the proportion that is not leaves, for example.‚Ü©Ô∏é\nThere were no convergence problems with models that included no interactions and intercept-only random effects.‚Ü©Ô∏é"
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Angelos Amyntas",
    "section": "",
    "text": "Angelos Amyntas\n\n\n\n\n\n\n\n\nI am a community ecologist. I am interested in understanding how the assembly of multi-trophic communities changes the functioning of ecosystems in space and across time."
  },
  {
    "objectID": "contact.html",
    "href": "contact.html",
    "title": "",
    "section": "",
    "text": "German Centre for Integrative Biodiversity Research (iDiv)\nPuschstra√üe 4\n04103 Leipzig\nGermany\nangelos[dot]amyntas[at]posteo[dot]net"
  },
  {
    "objectID": "about.html",
    "href": "about.html",
    "title": "about me",
    "section": "",
    "text": "I recently defended my PhD thesis. In February 2025 I will join Anne McLeod‚Äôs Computational Ecology group in IGB Berlin as a postdoc.\nThe last four and a half years, I did research in the context of the Jena Experiment, a longterm grassland biodiversity and ecosystem functioning field experiment, located outside of Jena in Thuringia, Germany. In that phase of the experiment, we were interested in understanding why the positive effect of plant diversity on ecosystem functions ‚Äî such as productivity ‚Äî apparently strengthens over time. My project focused on the belowground component of the ecosystem. We examined the effects of plant diversity on functions performed by the multi-trophic community of soil fauna, in old and new communities. This work combined a field experiment, a mesocosm experiment and a bit of modelling.\nMy experiences and readings during this time have shifted my attention towards diversity and functioning relationships at larger spatial scales and under changing environmental conditions. So, to the links that represent trophic relationships between different populations in a community, I am now adding the links that represent interconnected communities in a landscape. Networks everywhere.\n\n\n\nIt‚Äôs all connected.\n\n\nI am also increasingly enthusiastic about Bayesian statistics and Agent Based Modelling. For the first, after joining Richard McElreath‚Äôs course a couple of years ago, I am teaching myself Stan (although for my work, my needs are usually covered by {brms}). For the second, I am slowly working my way through Paul Smaldino‚Äôs Modeling social behavior: Mathematical and agent-based models of social dynamics and cultural evolution, solving the exercises in NetLogo and sometimes trying to do the same using Agents.jl. Why would an ecologist choose a social science textbook to learn ABMs? I like the way he thinks and writes about modelling.\nWhen I am not sciencing, I read novels, listen to noisy music, watch old films or wander about in nature. In order of decreasing frequency."
  },
  {
    "objectID": "posts/20240806/index.html",
    "href": "posts/20240806/index.html",
    "title": "test",
    "section": "",
    "text": "bla\n\n\n\nCitationBibTeX citation:@online{amyntas2024,\n  author = {Amyntas, Angelos},\n  title = {Test},\n  date = {2024-08-06},\n  url = {https://amynang.github.io/posts/20240806/},\n  langid = {en}\n}\nFor attribution, please cite this work as:\nAmyntas, Angelos. 2024. ‚ÄúTest.‚Äù August 6, 2024. https://amynang.github.io/posts/20240806/."
  },
  {
    "objectID": "posts.html",
    "href": "posts.html",
    "title": "posts",
    "section": "",
    "text": "Roots, stems & leaves\n\n\n\n\n\n\nproportional data\n\n\nDirichlet\n\n\nphylogenetic regression\n\n\n\nmodelling proportions and trying a phylogenetic regression, using data from 10.1002/ecy.3688\n\n\n\n\n\nSep 7, 2024\n\n\nAngelos Amyntas\n\n\n\n\n\n\n\n\n\n\n\n\ntest\n\n\n\n\n\n\nQuarto\n\n\n\nfiguring out how to write blog posts in quarto\n\n\n\n\n\nAug 6, 2024\n\n\nAngelos Amyntas\n\n\n\n\n\n\nNo matching items"
  }
]